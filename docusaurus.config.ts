/**
 * This is the default Docusaurus configuration.
 * Many values defined here are source from site-config/
 *
 * To avoid merge conflicts, do not edit this file. To override configuration,
 * use siteConfig.docusaurusConfig
 */

import type * as Preset from "@docusaurus/preset-classic";
import type { Config } from "@docusaurus/types";
import merge from "lodash.merge";
import path from "node:path";
import { themes as prismThemes } from "prism-react-renderer";
import siteConfig from "./site-config";
import {
  contentProcessPhrases,
  frontMatterProcessPhrases,
} from "./src/dynamicPhrases";

const config: Config = {
  title: `${siteConfig.phrases["%COMPANY%"]} ${siteConfig.phrases["%EMBEDDED_WORKFLOW_BUILDER%"]}`,
  tagline: `Connect ${siteConfig.phrases["%COMPANY_CORE_PRODUCT%"]} to the other apps you use`,
  favicon: "img/favicon.ico",
  url: siteConfig.docsSite.url,
  baseUrl: siteConfig.docsSite.baseUrl,
  onBrokenLinks: "throw", // Throw errors during the build process when links are broken
  onBrokenMarkdownLinks: "throw",
  onBrokenAnchors: "throw",
  i18n: {
    defaultLocale: "en",
    locales: ["en"],
  },
  presets: [
    [
      "classic",
      {
        docs: {
          routeBasePath: "/",
          sidebarPath: "./sidebars.ts",
        },
        blog: false,
        theme: { customCss: "./site-config/custom.css" },
      } satisfies Preset.Options,
    ],
  ],
  themeConfig: {
    navbar: siteConfig.navbar,
    footer: siteConfig.footer,
    colorMode: siteConfig.colorMode,
    prism: {
      theme: prismThemes.github,
      darkTheme: prismThemes.dracula,
    },
    tableOfContents: {
      minHeadingLevel: 2,
      maxHeadingLevel: 4,
    },
  } satisfies Preset.ThemeConfig,
  markdown: {
    format: "md",
    parseFrontMatter: frontMatterProcessPhrases,
    preprocessor: contentProcessPhrases,
  },
  plugins: [path.resolve(__dirname, "src/plugins/connectors/index.ts")],
  future: {
    experimental_faster: true,
  },
};

// Merge this config with optional user-provided config
export default merge(config, siteConfig.docusaurusConfig);
